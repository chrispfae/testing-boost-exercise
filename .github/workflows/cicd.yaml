name: SSE CI/CD
on: [push]
jobs:
  style_check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: "Install clang-format"
        run: sudo apt-get install -y clang-format
      - name: "Clang check src"
        run: clang-format --dry-run --Werror src/*
      - name: "Clang check tests"
        run: clang-format --dry-run --Werror tests/*cpp
  build_check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: "Install build requirements"
        run: |
          sudo apt-get install -y cmake
          sudo apt-get install -y make
          sudo apt-get install -y libboost-all-dev
          sudo apt-get install -y libeigen3-dev
          sudo apt-get install -y libyaml-cpp-dev
      - name: "Build code"
        run: |
          mkdir build
          cd build
          cmake ..
          make -j 4
  test_code:
    needs: build_check
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: "Test code"
        run: |
          cd tests
          cp ../build/testsidemade .
          ./testsidemade

